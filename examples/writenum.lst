mads 2.1.0
  3726 					opt l+
    95
    96 				.print 'RUNLIB: ',RUNLIB,'..',*
    96 				RUNLIB: $2082..$24D7
    97
    98 				; ------------------------------------------------------------
    99
   100 24D7			START
   101 24D7 BA				tsx
   102 24D8 8E 7A 26			stx MAIN.@halt+1
   103
   104 					.ifdef fmulinit
   105 					fmulinit
   106 					eif
   107
   108 = 011F			VLEN	= VARDATASIZE-VARINITSIZE
   109 = 2697			VADR	= DATAORIGIN+VARINITSIZE
   110
   111 					ift VADR > $BFFF
   112 					ert 'Invalid memory address range ',VADR
   113 					eli (VLEN>0) && (VLEN<=256)
   114 					ldx #256-VLEN
   115 					lda #0
   116 					sta:rne VADR+VLEN-256,x+
   117 					eli VLEN>0
   118 					@fill #VADR #VLEN #0
   118 				 MWA #VADR @FILL.PTR1\ MWA #VLEN @FILL.PTR3\ MVA #0 @FILL.PTR2\ JSR @FILL
   118 24DB A9 97 85 86 A9 26 +  MWA #VADR @FILL.PTR1
   118 24E3 A9 1F 85 8A A9 01 +  MWA #VLEN @FILL.PTR3
   118 24EB A9 00 85 82		 MVA #0 @FILL.PTR2
   118 24EF 20 69 24		 JSR @FILL
   119 					eif
   120
   121 24F2 A2 0F			ldx #$0f
   122 24F4 BD 40 03 9D 7D 26 + 	mva:rpl $340,x MAIN.IOCB@COPY,x-
   123
   124 24FD E8				inx		; X = 0 !!!
   125 24FE 86 8E			stx bp		; lo BP = 0
   126
   127 2500				UNITINITIALIZATION
Macro: UNITINITIALIZATION [Source: writenum.a65]
Source: writenum.a65
   128
   129 2500			.local	MAIN						; PROCEDURE
   130
   131 2500 4C 68 26			jmp l_0089
   132
   133 				; ------------------------------------------------------------
   134
   135 2503			.local	SYSTEM						; UNIT
   136
   137 				; ------------------------------------------------------------
   138
   139 = 0648			M_PI_2	= $0648
   140 = 0192			D_PI_2	= $0192
   141 = 0004			D_PI_180	= $0004
   142 = 0000			MGTIA	= $0000
   143 = 0080			MVBXE	= $0080
   144 = 0000			VBXE_XDLADR	= $0000
   145 = 0100			VBXE_BCBADR	= $0100
   146 = 1000			VBXE_MAPADR	= $1000
   147 = 5000			VBXE_OVRADR	= $5000
   148 = B000			VBXE_WINDOW	= $B000
   149 = 0000			IDLI	= $0000
   150 = 0001			IVBL	= $0001
   151 = 00FE			CH_DELCHR	= $00FE
   152 = 009B			CH_ENTER	= $009B
   153 = 001B			CH_ESC	= $001B
   154 = 001C			CH_CURS_UP	= $001C
   155 = 001D			CH_CURS_DOWN	= $001D
   156 = 001E			CH_CURS_LEFT	= $001E
   157 = 001F			CH_CURS_RIGHT	= $001F
   158 = 007F			CH_TAB	= $007F
   159 = 009B			CH_EOL	= $009B
   160 = 007D			CH_CLR	= $007D
   161 = 00FD			CH_BELL	= $00FD
   162 = 007E			CH_DEL	= $007E
   163 = 009C			CH_DELLINE	= $009C
   164 = 009D			CH_INSLINE	= $009D
   165 = 0000			COLOR_BLACK	= $0000
   166 = 000E			COLOR_WHITE	= $000E
   167 = 0032			COLOR_RED	= $0032
   168 = 0096			COLOR_CYAN	= $0096
   169 = 0068			COLOR_VIOLET	= $0068
   170 = 00C4			COLOR_GREEN	= $00C4
   171 = 0074			COLOR_BLUE	= $0074
   172 = 00EE			COLOR_YELLOW	= $00EE
   173 = 0028			COLOR_ORANGE	= $0028
   174 = 00E4			COLOR_BROWN	= $00E4
   175 = 003C			COLOR_LIGHTRED	= $003C
   176 = 0004			COLOR_GRAY1	= $0004
   177 = 0006			COLOR_GRAY2	= $0006
   178 = 000A			COLOR_GRAY3	= $000A
   179 = 00CC			COLOR_LIGHTGREEN	= $00CC
   180 = 007C			COLOR_LIGHTBLUE	= $007C
   181 = 0004			FMOPENREAD	= $0004
   182 = 0008			FMOPENWRITE	= $0008
   183 = 0009			FMOPENAPPEND	= $0009
   184 = 000C			FMOPENREADWRITE	= $000C
   185 = 2691			SCREENWIDTH	= DATAORIGIN+$0000
   186 = 2693			SCREENHEIGHT	= DATAORIGIN+$0002
   187 = 2695			DATESEPARATOR	= DATAORIGIN+$0004
   188 = D014			TVSYSTEM	= $D014
   189 = 02C0			adr.PALETTE	= $02C0
   190 2503			.var PALETTE	= adr.PALETTE .word
   191 = D012			adr.HPALETTE	= $D012
   192 2503			.var HPALETTE	= adr.HPALETTE .word
   193 = 2696			FILEMODE	= DATAORIGIN+$0005
   194 = 2697			SCREENMODE	= DATAORIGIN+$0006
   195 = 2698			IORESULT	= DATAORIGIN+$0007
   196 = 2699			EOLN	= DATAORIGIN+$0008
   197 = 269A			RNDSEED	= DATAORIGIN+$0009
   198
   199 = 2503 C0 02		PALETTE
   199 = 2505 12 D0		HPALETTE
   199 				.endl							; UNIT SYSTEM
   200
   201 				; ------------------------------------------------------------
   202
   203 2507			.local	DOS						; UNIT
   204
   205 				; ------------------------------------------------------------
   206
   207 = D014			PALNTSC	= $D014
   208
   209 				.endl							; UNIT DOS
   210
   211 				; ------------------------------------------------------------
   212
   213 2507			.local	STRUTILS					; UNIT
   214
   215 				; ------------------------------------------------------------
   216
   217 				.endl							; UNIT STRUTILS
   218
   219 				; ------------------------------------------------------------
   220
   221 2507			.local	SYSUTILS					; UNIT
   222
   223 2507			.local	INTTOSTR					; FUNCTION | ASSEMBLER
   224
   225 				; ------------------------------------------------------------
   226
   227 				; Generate Assignment for CARDINAL / INTEGER / REAL / SINGLE
   228 				; as Pointer
   229 2507 B5 98 8D 9C 26		mva :STACKORIGIN,x A
   230 250C B5 A8 8D 9D 26		mva :STACKORIGIN+STACKWIDTH,x A+1
   231 2511 B5 B8 8D 9E 26		mva :STACKORIGIN+STACKWIDTH*2,x A+2
   232 2516 B5 C8 8D 9F 26		mva :STACKORIGIN+STACKWIDTH*3,x A+3
   233 251B CA				dex						; sub bx, 1
   234
   235 				; ---------------------  ASM Block 057  ---------------------
   236
   237 251C 8A 48			txa:pha
   238
   239 251E E8				inx
   240
   241 					@ValueToStr #@printINT
   241 				 LDY> @PRINTINT\ LDA< @PRINTINT\ JSR @VALUETOSTR
   241 251F A0 23		 LDY> @PRINTINT
   241 2521 A9 00		 LDA< @PRINTINT
   241 2523 20 8E 23		 JSR @VALUETOSTR
   242
   243 2526 A9 00 8D A0 26 A9 + 	mwa #@buf Result
   244
   245 2530 68 AA			pla:tax
   246
   247 2532			@exit
   248
   249 				; ------------------------------------------------------------
   250
   251 				; Push WORD / SMALLINT / SHORTREAL / POINTER
   252 				; as Pointer
   253
   254 2532 E8				inx						; add bx, 1
   255 2533 AD A0 26 95 98		mva RESULT :STACKORIGIN,x
   256 2538 AD A1 26 95 A8		mva RESULT+1 :STACKORIGIN+STACKWIDTH,x
   257
   258 					.ifdef @new
   259 					@FreeMem #@VarData #@VarDataSize
   260 					eif
   261
   262 				; ------------------------------------------------------------
   263
   264 = 269C			A	= DATAORIGIN+$000B
   265 = 26A0			RESULT	= DATAORIGIN+$000F
   266
   267 = 269C			@VarData	= A
   268 = 0006			@VarDataSize	= 6
   269
   270 253D 60				rts						; ret
   271 				.endl
   272
   273 				; ------------------------------------------------------------
   274
   275 = 0001			FAREADONLY	= $0001
   276 = 0002			FAHIDDEN	= $0002
   277 = 0004			FASYSFILE	= $0004
   278 = 0008			FAVOLUMEID	= $0008
   279 = 0010			FADIRECTORY	= $0010
   280 = 0020			FAARCHIVE	= $0020
   281 = 003F			FAANYFILE	= $003F
   282
   283 				.endl							; UNIT SYSUTILS
   284
   285 				; ------------------------------------------------------------
   286
   287 253E			.local	ATARI						; UNIT
   288
   289 				; ------------------------------------------------------------
   290
   291 = 0012			RTCLOK	= $0012
   292 = 004D			ATRACT	= $004D
   293 = 0052			LMARGIN	= $0052
   294 = 0053			RMARGIN	= $0053
   295 = 0054			ROWCRS	= $0054
   296 = 0055			COLCRS	= $0055
   297 = 0057			DINDEX	= $0057
   298 = 0058			SAVMSC	= $0058
   299 = 006A			RAMTOP	= $006A
   300 = 0200			VDSLST	= $0200
   301 = 0230			SDLSTL	= $0230
   302 = 0290			TXTROW	= $0290
   303 = 0291			TXTCOL	= $0291
   304 = 0293			TINDEX	= $0293
   305 = 0294			TXTMSC	= $0294
   306 = 022F			SDMCTL	= $022F
   307 = 026F			GPRIOR	= $026F
   308 = 02F0			CRSINH	= $02F0
   309 = 02F3			CHACT	= $02F3
   310 = 02F4			CHBAS	= $02F4
   311 = 02FC			CH	= $02FC
   312 = 02C0			PCOLR0	= $02C0
   313 = 02C1			PCOLR1	= $02C1
   314 = 02C2			PCOLR2	= $02C2
   315 = 02C3			PCOLR3	= $02C3
   316 = 02C4			COLOR0	= $02C4
   317 = 02C5			COLOR1	= $02C5
   318 = 02C6			COLOR2	= $02C6
   319 = 02C7			COLOR3	= $02C7
   320 = 02C8			COLOR4	= $02C8
   321 = 02C8			COLBAKS	= $02C8
   322 = D000			HPOSP0	= $D000
   323 = D001			HPOSP1	= $D001
   324 = D002			HPOSP2	= $D002
   325 = D003			HPOSP3	= $D003
   326 = D004			HPOSM0	= $D004
   327 = D005			HPOSM1	= $D005
   328 = D006			HPOSM2	= $D006
   329 = D007			HPOSM3	= $D007
   330 = D008			SIZEP0	= $D008
   331 = D009			SIZEP1	= $D009
   332 = D00A			SIZEP2	= $D00A
   333 = D00B			SIZEP3	= $D00B
   334 = D00C			SIZEM	= $D00C
   335 = D00D			GRAFP0	= $D00D
   336 = D00E			GRAFP1	= $D00E
   337 = D00F			GRAFP2	= $D00F
   338 = D010			GRAFP3	= $D010
   339 = D011			GRAFM	= $D011
   340 = D004			P0PF	= $D004
   341 = D014			PAL	= $D014
   342 = D012			COLPM0	= $D012
   343 = D013			COLPM1	= $D013
   344 = D014			COLPM2	= $D014
   345 = D015			COLPM3	= $D015
   346 = D016			COLPF0	= $D016
   347 = D017			COLPF1	= $D017
   348 = D018			COLPF2	= $D018
   349 = D019			COLPF3	= $D019
   350 = D01A			COLBK	= $D01A
   351 = D01B			PRIOR	= $D01B
   352 = D01D			GRACTL	= $D01D
   353 = D01E			HITCLR	= $D01E
   354 = D200			AUDF1	= $D200
   355 = D201			AUDC1	= $D201
   356 = D202			AUDF2	= $D202
   357 = D203			AUDC2	= $D203
   358 = D204			AUDF3	= $D204
   359 = D205			AUDC3	= $D205
   360 = D206			AUDF4	= $D206
   361 = D207			AUDC4	= $D207
   362 = D208			AUDCTL	= $D208
   363 = D20F			SKSTAT	= $D20F
   364 = D301			PORTB	= $D301
   365 = D400			DMACTL	= $D400
   366 = D401			CHACTL	= $D401
   367 = D402			DLISTL	= $D402
   368 = D404			HSCROL	= $D404
   369 = D405			VSCROL	= $D405
   370 = D407			PMBASE	= $D407
   371 = D409			CHBASE	= $D409
   372 = D40A			WSYNC	= $D40A
   373 = D40B			VCOUNT	= $D40B
   374 = D40C			PENH	= $D40C
   375 = D40D			PENV	= $D40D
   376 = D40E			NMIEN	= $D40E
   377
   378 				.endl							; UNIT ATARI
   379
   380 				; ------------------------------------------------------------
   381
   382 253E			.local	CRT						; UNIT
   383
   384 253E			.local	READKEY						; FUNCTION | ASSEMBLER
   385
   386 				; ---------------------  ASM Block 063  ---------------------
   387
   388 253E 8A 48			txa:pha
   389
   390 2540 20 BC 23			@GetKey
   391
   392 2543 8D A3 26			sta Result
   393
   394 2546 68 AA			pla:tax
   395
   396 2548			@exit
   397
   398 				; ------------------------------------------------------------
   399
   400 				; Push BYTE / CHAR / SHORTINT / BOOLEAN
   401 				; as Pointer
   402
   403 2548 E8				inx						; add bx, 1
   404 2549 AD A3 26 95 98		mva RESULT :STACKORIGIN,x
   405
   406 					.ifdef @new
   407 					@FreeMem #@VarData #@VarDataSize
   408 					eif
   409
   410 				; ------------------------------------------------------------
   411
   412 = 26A3			RESULT	= DATAORIGIN+$0012
   413
   414 = 26A3			@VarData	= RESULT
   415 = 0001			@VarDataSize	= 1
   416
   417 254E 60				rts						; ret
   418 				.endl
   419
   420 				; ------------------------------------------------------------
   421
   422 = 26A2			TEXTATTR	= DATAORIGIN+$0011
   423 = D01F			CONSOL	= $D01F
   424 = 0000			CN_START_SELECT_OPTION	= $0000
   425 = 0001			CN_SELECT_OPTION	= $0001
   426 = 0002			CN_START_OPTION	= $0002
   427 = 0003			CN_OPTION	= $0003
   428 = 0004			CN_START_SELECT	= $0004
   429 = 0005			CN_SELECT	= $0005
   430 = 0006			CN_START	= $0006
   431 = 0007			CN_NONE	= $0007
   432 = 0000			BW40	= $0000
   433 = 0001			CO40	= $0001
   434 = 0002			BW80	= $0002
   435 = 0003			CO80	= $0003
   436 = 0007			MONO	= $0007
   437 = 0001			C40	= $0001
   438 = 0003			C80	= $0003
   439 = 0000			BLACK	= $0000
   440 = 0001			BLUE	= $0001
   441 = 0002			GREEN	= $0002
   442 = 0003			CYAN	= $0003
   443 = 0004			RED	= $0004
   444 = 0005			MAGENTA	= $0005
   445 = 0006			BROWN	= $0006
   446 = 0007			LIGHTGRAY	= $0007
   447 = 0008			DARKGRAY	= $0008
   448 = 0009			LIGHTBLUE	= $0009
   449 = 000A			LIGHTGREEN	= $000A
   450 = 000B			LIGHTCYAN	= $000B
   451 = 000C			LIGHTRED	= $000C
   452 = 000D			LIGHTMAGENTA	= $000D
   453 = 000E			YELLOW	= $000E
   454 = 000F			WHITE	= $000F
   455 = 0080			BLINK	= $0080
   456
   457 				.endl							; UNIT CRT
   458
   459 254F			.local	MAINPROC					; PROCEDURE
   460
   461 				; optimize FAIL (100, examples\writenum.pas), line = 22
   462 					@print #$7D
   462 				 LDY# $7D\ JSR @PRINT
   462 254F A0 7D		 LDY# $7D
   462 2551 20 AB 22		 JSR @PRINT
   463
   464 				; optimize FAIL (100, examples\writenum.pas), line = 23
   465 					@printSTRING #CODEORIGIN+$000D
   465 				 LDY> CODEORIGIN+$000D\ LDA< CODEORIGIN+$000D\ JSR @PRINTSTRING
   465 2554 A0 20		 LDY> CODEORIGIN+$000D
   465 2556 A9 0D		 LDA< CODEORIGIN+$000D
   465 2558 20 B4 22		 JSR @PRINTSTRING
   466 					@print #$9B
   466 				 LDY# $9B\ JSR @PRINT
   466 255B A0 9B		 LDY# $9B
   466 255D 20 AB 22		 JSR @PRINT
   467 					@printSTRING #CODEORIGIN+$001E
   467 				 LDY> CODEORIGIN+$001E\ LDA< CODEORIGIN+$001E\ JSR @PRINTSTRING
   467 2560 A0 20		 LDY> CODEORIGIN+$001E
   467 2562 A9 1E		 LDA< CODEORIGIN+$001E
   467 2564 20 B4 22		 JSR @PRINTSTRING
   468 					@print #$9B
   468 				 LDY# $9B\ JSR @PRINT
   468 2567 A0 9B		 LDY# $9B
   468 2569 20 AB 22		 JSR @PRINT
   469 					@printSTRING #CODEORIGIN+$001D
   469 				 LDY> CODEORIGIN+$001D\ LDA< CODEORIGIN+$001D\ JSR @PRINTSTRING
   469 256C A0 20		 LDY> CODEORIGIN+$001D
   469 256E A9 1D		 LDA< CODEORIGIN+$001D
   469 2570 20 B4 22		 JSR @PRINTSTRING
   470 				; AssignFile
   471
   472 				; optimize OK (examples\writenum.pas), line = 24
   473
   474 2573 AD 8D 26 85 90 AD + 	mwa F :bp2
   475 257D A0 00			ldy #s@file.pfname
   476 257F A9 20			lda #$20
   477 2581 91 90			sta (:bp2),y
   478 2583 C8				iny
   479 2584 91 90			sta (:bp2),y
   480
   481 				; optimize OK (examples\writenum.pas), line = 24
   482
   483 2586 A0 05			ldy #s@file.status
   484 2588 A9 00			lda #$00
   485 258A 91 90			sta (:bp2),y
   486 				; Rewrite
   487
   488 				; optimize OK (examples\writenum.pas), line = 25
   489
   490 258C A0 02			ldy #s@file.record
   491 258E A9 01			lda #$01
   492 2590 91 90			sta (:bp2),y
   493 2592 C8				iny
   494 2593 A9 00			lda #$00
   495 2595 91 90			sta (:bp2),y
   496
   497 2597 8A 48			txa:pha
   498 2599 38				sec
   499 					@openfile F, #8
   499 				 LDY F+1\ LDA F\ LDX# 8\ JSR @OPENFILE
   499 259A AC 8E 26		 LDY F+1
   499 259D AD 8D 26		 LDA F
   499 25A0 A2 08		 LDX# 8
   499 25A2 20 B9 20		 JSR @OPENFILE
   500 25A5 68 AA			pla:tax
   501
   502 				; optimize FAIL (100, examples\writenum.pas), line = 26
   503 					@printSTRING #CODEORIGIN+$0030
   503 				 LDY> CODEORIGIN+$0030\ LDA< CODEORIGIN+$0030\ JSR @PRINTSTRING
   503 25A7 A0 20		 LDY> CODEORIGIN+$0030
   503 25A9 A9 30		 LDA< CODEORIGIN+$0030
   503 25AB 20 B4 22		 JSR @PRINTSTRING
   504 25AE 20 A6 22			@printEOL
   505 				; --- For
   506
   507 				; optimize OK (examples\writenum.pas), line = 27
   508
   509 25B1 A9 01 8D B4 27		mva #$01 I
   510
   511 				; optimize OK (examples\writenum.pas), line = 27
   512
   513 				; --- To
   514 25B6			l_0107
   515
   516 				; --- ForToDoCondition
   517
   518 				; optimize OK (examples\writenum.pas), line = 27
   519
   520 25B6 AD B4 27			lda I
   521 25B9 C9 0C			cmp #$0C
   522 25BB 90 02			scc
   523 25BD D0 68			jne l_0115
   524
   525 				; optimize FAIL ('SYSUTILS.INTTOSTR', examples\writenum.pas), line = 28
   526 25BF E8				inx
   527 25C0 AD B4 27 95 98		mva I :STACKORIGIN,x
   528 25C5 20 96 20			jsr @expandToCARD.BYTE
   529 25C8 20 07 25			jsr SYSUTILS.INTTOSTR
   530 					@moveSTRING STRBUFFER
   530 				 LDY STRBUFFER+1\ LDA STRBUFFER\ JSR @MOVESTRING
   530 25CB AC 90 26		 LDY STRBUFFER+1
   530 25CE AD 8F 26		 LDA STRBUFFER
   530 25D1 20 CC 23		 JSR @MOVESTRING
   531 25D4 CA				dex						; sub bx, 1
   532 				; BlockWrite
   533
   534 				; optimize OK (examples\writenum.pas), line = 29
   535
   536 25D5 AD 8D 26 85 90 AD + 	mwa F :bp2
   537 25DF A0 06			ldy #s@file.buffer
   538 25E1 AD 8F 26			lda STRBUFFER
   539 25E4 18 69 01			add #$01
   540 25E7 91 90			sta (:bp2),y
   541 25E9 C8				iny
   542 25EA AD 90 26			lda STRBUFFER+1
   543 25ED 69 00			adc #$00
   544 25EF 91 90			sta (:bp2),y
   545
   546 				; optimize OK (examples\writenum.pas), line = 29
   547
   548 25F1 AD 8F 26 85 90 AD + 	mwa STRBUFFER :bp2
   549 25FB A0 00			ldy #0
   550 25FD B1 90			lda (:bp2),y
   551 25FF AC 8D 26 84 90 AC + 	mwy F :bp2
   552 2609 A0 08			ldy #s@file.nrecord
   553 260B 91 90			sta (:bp2),y
   554 260D C8				iny
   555 260E A9 00			lda #$00
   556 2610 91 90			sta (:bp2),y
   557
   558 2612 8A 48			txa:pha
   559 2614 38				sec
   560 					@readfile F, #11
   560 				 LDY F+1\ LDA F\ LDX# 11\ JSR @READFILE
   560 2615 AC 8E 26		 LDY F+1
   560 2618 AD 8D 26		 LDA F
   560 261B A2 0B		 LDX# 11
   560 261D 20 8D 21		 JSR @READFILE
   561 2620 68 AA			pla:tax
   562
   563 				; --- ForToDoEpilog
   564 2622 EE B4 27			inc I						; inc ptr byte [CounterAddress]
   565
   566 2625 D0 8F			jne l_0107
   567
   568 2627			l_0115
   569 				; CloseFile
   570
   571 2627 8A 48			txa:pha
   572 2629 38				sec
   573 					@closefile F
   573 				 LDY F+1\ LDA F\ JSR @CLOSEFILE
   573 262A AC 8E 26		 LDY F+1
   573 262D AD 8D 26		 LDA F
   573 2630 20 60 21		 JSR @CLOSEFILE
   574 2633 68 AA			pla:tax
   575
   576 				; optimize FAIL (100, examples\writenum.pas), line = 32
   577 					@printSTRING #CODEORIGIN+$004A
   577 				 LDY> CODEORIGIN+$004A\ LDA< CODEORIGIN+$004A\ JSR @PRINTSTRING
   577 2635 A0 20		 LDY> CODEORIGIN+$004A
   577 2637 A9 4A		 LDA< CODEORIGIN+$004A
   577 2639 20 B4 22		 JSR @PRINTSTRING
   578 263C 20 A6 22			@printEOL
   579
   580 				; optimize FAIL (100, examples\writenum.pas), line = 33
   581 					@printSTRING #CODEORIGIN+$001D
   581 				 LDY> CODEORIGIN+$001D\ LDA< CODEORIGIN+$001D\ JSR @PRINTSTRING
   581 263F A0 20		 LDY> CODEORIGIN+$001D
   581 2641 A9 1D		 LDA< CODEORIGIN+$001D
   581 2643 20 B4 22		 JSR @PRINTSTRING
   582 					@print #$9B
   582 				 LDY# $9B\ JSR @PRINT
   582 2646 A0 9B		 LDY# $9B
   582 2648 20 AB 22		 JSR @PRINT
   583 					@printSTRING #CODEORIGIN+$001D
   583 				 LDY> CODEORIGIN+$001D\ LDA< CODEORIGIN+$001D\ JSR @PRINTSTRING
   583 264B A0 20		 LDY> CODEORIGIN+$001D
   583 264D A9 1D		 LDA< CODEORIGIN+$001D
   583 264F 20 B4 22		 JSR @PRINTSTRING
   584 					@print #$9B
   584 				 LDY# $9B\ JSR @PRINT
   584 2652 A0 9B		 LDY# $9B
   584 2654 20 AB 22		 JSR @PRINT
   585 					@printSTRING #CODEORIGIN+$0066
   585 				 LDY> CODEORIGIN+$0066\ LDA< CODEORIGIN+$0066\ JSR @PRINTSTRING
   585 2657 A0 20		 LDY> CODEORIGIN+$0066
   585 2659 A9 66		 LDA< CODEORIGIN+$0066
   585 265B 20 B4 22		 JSR @PRINTSTRING
   586
   587 				; optimize FAIL ('CRT.READKEY', examples\writenum.pas), line = 34
   588 265E 20 3E 25			jsr CRT.READKEY
   589 2661 B5 98 8D B5 27		mva :STACKORIGIN,x KEY
   590 2666 CA				dex
   591
   592 				; ------------------------------------------------------------
   593
   594 = 27B4			I	= DATAORIGIN+$0123
   595 = 27B5			KEY	= DATAORIGIN+$0124
   596 = 000C			@FORTMP_0104	= $000C
   597
   598 = 27B4			@VarData	= I
   599 = 0002			@VarDataSize	= 2
   600
   601 2667			@exit
   602 					.ifdef @new
   603 					@FreeMem #@VarData #@VarDataSize
   604 					eif
   605 2667 60				rts						; ret
   606 				.endl
   607 2668			l_0089
   608
   609 				; optimize FAIL ('MAINPROC', examples\writenum.pas), line = 38
   610 2668 20 4F 25			jsr MAINPROC
   611 				; CloseFile
   612
   613 266B 8A 48			txa:pha
   614 266D 38				sec
   615 					@closefile F
   615 				 LDY F+1\ LDA F\ JSR @CLOSEFILE
   615 266E AC 8E 26		 LDY F+1
   615 2671 AD 8D 26		 LDA F
   615 2674 20 60 21		 JSR @CLOSEFILE
   616 2677 68 AA			pla:tax
   617
   618 				; ------------------------------------------------------------
   619
   620 = 26A4			INTVALUE	= DATAORIGIN+$0013
   621 2679			.var F	= DATAORIGIN+$0017 .word
   622 = 26B4			adr.STRBUFFER	= DATAORIGIN+$0023
   623 2679			.var STRBUFFER	= adr.STRBUFFER .word
   624 2679			@exit
   625
   626 2679 A2 00		@halt	ldx #0
   627 267B 9A				txs
   628
   629 267C 60				rts
   630
   631 				; ------------------------------------------------------------
   632
   633 267D 00 00 00 00 00 00 + IOCB@COPY	:16 brk
   634
   635 				; ------------------------------------------------------------
   636
   637 268D			.local	@DEFINES
   638 268D			ATARI
   639 				.endl
   640
   641 = 268D A8 26		F
   641 = 268F B4 26		STRBUFFER
   641 				.endl							; MAIN
   642
   643 				; ------------------------------------------------------------
   644 				; ------------------------------------------------------------
   645
   646 				.macro	UNITINITIALIZATION
   647 				
   648 					.ifdef MAIN.SYSTEM.@UnitInit
   649 					jsr MAIN.SYSTEM.@UnitInit
   650 					eif
   651 				
   652 					.ifdef MAIN.DOS.@UnitInit
   653 					jsr MAIN.DOS.@UnitInit
   654 					eif
   655 				
   656 					.ifdef MAIN.STRUTILS.@UnitInit
   657 					jsr MAIN.STRUTILS.@UnitInit
   658 					eif
   659 				
   660 					.ifdef MAIN.SYSUTILS.@UnitInit
   661 					jsr MAIN.SYSUTILS.@UnitInit
   662 					eif
   663 				
   664 					.ifdef MAIN.ATARI.@UnitInit
   665 					jsr MAIN.ATARI.@UnitInit
   666 					eif
   667 				
   668 					.ifdef MAIN.CRT.@UnitInit
   669 					jsr MAIN.CRT.@UnitInit
   670 					eif
   671 				.endm
   672
   673 				; ------------------------------------------------------------
   674
   675 					ift .SIZEOF(MAIN.SYSTEM) > 0
   676 					.print 'SYSTEM: ',MAIN.SYSTEM,'..',MAIN.SYSTEM+.SIZEOF(MAIN.SYSTEM)-1
   676 				SYSTEM: $2503..$2506
   677 					eif
   678
   679 					ift .SIZEOF(MAIN.DOS) > 0
   680 					.print 'DOS: ',MAIN.DOS,'..',MAIN.DOS+.SIZEOF(MAIN.DOS)-1
   681 					eif
   682
   683 					ift .SIZEOF(MAIN.STRUTILS) > 0
   684 					.print 'STRUTILS: ',MAIN.STRUTILS,'..',MAIN.STRUTILS+.SIZEOF(MAIN.STRUTILS)-1
   685 					eif
   686
   687 					ift .SIZEOF(MAIN.SYSUTILS) > 0
   688 					.print 'SYSUTILS: ',MAIN.SYSUTILS,'..',MAIN.SYSUTILS+.SIZEOF(MAIN.SYSUTILS)-1
   688 				SYSUTILS: $2507..$253D
   689 					eif
   690
   691 					ift .SIZEOF(MAIN.ATARI) > 0
   692 					.print 'ATARI: ',MAIN.ATARI,'..',MAIN.ATARI+.SIZEOF(MAIN.ATARI)-1
   693 					eif
   694
   695 					ift .SIZEOF(MAIN.CRT) > 0
   696 					.print 'CRT: ',MAIN.CRT,'..',MAIN.CRT+.SIZEOF(MAIN.CRT)-1
   696 				CRT: $253E..$254E
   697 					eif
   698
   699 					.print 'CODE: ',CODEORIGIN,'..',*-1
   699 				CODE: $2000..$2690
   700
   701 				; ------------------------------------------------------------
   702
   703 2691			DATAORIGIN
   704 2691 28 00 18 00 2D 0C	.by  $28 $00 $18 $00 $2D $0C
   705
   706 = 0006			VARINITSIZE	= *-DATAORIGIN
   707 = 0125			VARDATASIZE	= 293
   708
   709 = 27B6			PROGRAMSTACK	= DATAORIGIN+VARDATASIZE
   710
   711 					.print 'DATA: ',DATAORIGIN,'..',PROGRAMSTACK
   711 				DATA: $2691..$27B6
   712
   713 02E0-02E1> D7 24			run START
   714
   715 				; ------------------------------------------------------------
   716
   717 				.macro	STATICDATA
   718 				.by  $04 $54 $52 $55 $45 $00 $05 $46  $41 $4C $53 $45 $00 $0F $50 $72  $69 $6E $74 $42 $44 $20 $65 $78
   719 				.by  $61 $6D $70 $6C $65 $00 $00 $00  $0E $48 $31 $3A $54 $45 $53 $54  $4E $55 $4D $2E $54 $58 $54 $00
   720 				.by  $18 $57 $72 $69 $74 $65 $20 $6E  $75 $6D $62 $65 $72 $73 $20 $74  $6F $20 $64 $69 $73 $6B $2E $2E
   721 				.by  $2E $00 $1A $44 $6F $6E $65 $21  $28 $66 $69 $6C $65 $20 $48 $31  $3A $54 $45 $53 $54 $4E $55 $4D
   722 				.by  $2E $54 $58 $54 $29 $00 $1A $50  $72 $65 $73 $73 $20 $61 $6E $79  $20 $6B $65 $79 $20 $74 $6F $20
   723 				.by  $63 $6F $6E $74 $69 $6E $75 $65  $21 $00
   724 				.endm
   725
   726 					end
